<!DOCTYPE html>
<html>
	<head>
		<title>Interactive WordPress tutorial!</title>
		<link rel="stylesheet" href="./style.css" />
	</head>
	<body>
		<iframe style="width: 600px;height:600px;border: 1px solid #000"></iframe>
		<script>
			if ( ! navigator.serviceWorker ) {
				alert( 'Service workers are not supported by your browser' );
			}
			const serviceWorkerReady = navigator.serviceWorker.register( `/slim-service-worker.js` );

			const myWorker = new Worker('webworker.js');
			const webWorkerReady = new Promise((resolve, reject) => {
				const callback = (event) => {
					if ( event.data.type === 'ready' ) {
						resolve()
						myWorker.removeEventListener('message', callback)
					}
				}
				myWorker.addEventListener('message', callback)
			});
			
			async function main() {
				await serviceWorkerReady;
				await webWorkerReady;
				console.log("Web worker ready, yay!");
				document.querySelector('iframe').src = "/wp-login.php";
			}
			main();
		</script>
	</body>
</html>
